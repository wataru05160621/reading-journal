# 01_要件定義（FR/NFR）＆フェーズ計画
最終更新: 2025-08-31 (JST)

## 1. 目的とスコープ
- **目的**: 読書記録を“最小ストレス”で継続できる体験の提供（モバイル/タブレット/WEB 同一アカウント）。
- **MVPスコープ**: 本の追加（検索/手動/ISBN）、階層管理（分類→棚→本→目次*）、本/章へのメモ・タグ・評価（章はPhase2）、進捗の可視化、CSVエクスポート、簡易オフライン。
- *目次(ToC)はP1では手動入力、P2でOCR＋自動パース。

## 2. 機能要件（FR）
### 2.1 アカウント/認証
- 同一アカウントでモバイル/タブレット/WEB にログインできる
- 表示設定（本棚ビュー切替など）を端末間で同期

### 2.2 ライブラリ階層
- **分類 → 本棚 → 本 → 目次（章）**
- MVPは分類1層/棚1層（入れ子はPhase2+）
- 作成/編集/移動/並べ替え/削除（論理削除）

### 2.3 本情報の取得/追加
- ネット検索（タイトル/著者/ISBN）→一覧→追加（重複検知）
- 書誌APIからタイトル/著者/ISBN/サムネ取得（目次は任意）

### 2.4 本棚ビュー
- **サムネイル**／**テキスト（ディレクトリ風）** の切替
- ユーザー設定として保持

### 2.5 コメント/評価/タグ
- **本**にコメント・★評価・タグ（MVP）
- **章（目次項目）**へのコメント/タグ/評価（Phase2）

### 2.6 進捗の可視化
- 本ごとの進捗％（読了章/総章 or ページ）
- ダッシュボード：直近/当月の概況（Phase1は簡易、Phase2で週/月集計強化）

### 2.7 目次作成（ToC）
- P1: 手動入力→プレビュー→一括保存
- P2: OCR入力（端末内優先）＋自動パース＋信頼度表示

### 2.8 エクスポート
- CSV（books / library_items / reading_sessions / *toc*）

## 3. 非機能要件（NFR）
- **対応/表示**: スマホ/タブレット/PC、レスポンシブ
- **性能**: 初回<3s、検索<1.5s（外部API遅延はローディング表示）
- **セキュリティ**: TLS、RLSによるユーザーデータ分離、最小権限、監査ログ
- **信頼性**: 基本フローの P99 失敗率 < 0.5%
- **アクセシビリティ**: キーボード操作/代替テキスト/コントラスト基準
- **プライバシー**: OCR画像は保存せず、テキストのみ保持（個人利用専用）
- **バックアップ**: 日次バックアップ/リストア手順
- **観測性**: エラートラッキング、イベント計測（PostHog/Amplitude想定）

## 4. フェーズ計画（対話駆動）
| フェーズ | 期間 | ゴール | 主な含有機能 | 後回し |
|---|---:|---|---|---|
| **P0 要件確定** | 2–3日 | FR/NFR合意、受入基準ドラフト | 本ドキュメント確定 | 技術詳細 |
| **P1 MVPコア** | 2週 | 単一ユーザーが全端末で基本操作 | 認証／分類1層+棚1層／ネット検索+追加／ビュー切替／本へのコメント・評価・タグ／進捗％／ToC手動 | 章への評価/タグ、入れ子棚、詳細集計 |
| **P2 UX拡張** | 2週 | 章単位の管理と集計 | ToC OCR＋自動パース／章へのコメント・タグ・評価／週・月集計 | 完全オフライン、通知 |
| **P3 運用品質** | 2週 | 快適性と運用安定 | 性能最適化／簡易オフライン再送／監査強化／CSVにToC追加 | SNS共有等 |

## 5. 受け入れ基準（サンプル）
- 認証: 3種端末で同一アカウントにログインでき、ビュー設定が同期される
- 本検索/追加: タイトル/著者/ISBN いずれでも検索→2タップ以内で追加、重複警告
- 階層操作: 分類/棚/本の作成・移動・削除・並べ替えがUIで完結
- ダッシュボード: 本ごとの進捗％と直近/当月の概況が見える
- ToC: 手動入力→プレビュー→一括保存ができる（P1）

## 6. ペルソナ/価値仮説（抜粋）
- P1 忙しい社会人/開発者：1タップ記録と直近本のクイック操作
- P2 学習者：進捗％/ストリークで維持
- 仮説：入力摩擦を最小化することで継続率が上がる

